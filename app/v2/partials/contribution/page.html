<style>
    .page__header a {
      text-decoration: none;
    }

    .action-bar .action-button {
      margin-top: 10px;
    }

    .action-button svg g {
      fill: #11493b;
    }

    .campaign_cards .attachments {
      float: left;
    }

    .campaign_cards .attachments-shrinked {
      width: 60%;
    }

    .campaign_cards .list--ideas {
      left: 0;
    }

    .nav-tabs {
      border-bottom: 1px solid #c6c8cb;
    }

    .nav-tabs>li {
      float: left;
      margin-bottom: -1px;
    }

    .nav-tabs>li>a {
      margin-right: 2px;
      line-height: 1.42857143;
      border: 1px solid transparent;
      border-radius: 4px 4px 0 0;
      color: #555;
      text-decoration: none;
    }

    .nav-tabs>li>a:hover {
      border-color: #eeeeee #eeeeee #c6c8cb;
      background-color: #e6e7e8;
    }

    .nav-tabs>li.active>a,
    .nav-tabs>li.active>a:hover,
    .nav-tabs>li.active>a:focus {
      color: #555555;
      background-color: #e6e7e8;
      border: 1px solid #c6c8cb;
      border-bottom-color: transparent;
      cursor: default;
    }

    .nav-tabs.nav-justified {
      width: 100%;
      border-bottom: 0;
    }

    .nav-tabs.nav-justified>li {
      float: none;
    }

    .nav-tabs.nav-justified>li>a {
      text-align: center;
      margin-bottom: 5px;
    }

    .nav-tabs.nav-justified>.dropdown .dropdown-menu {
      top: auto;
      left: auto;
    }

    @media (min-width: 768px) {
      .nav-tabs.nav-justified>li {
        display: table-cell;
        width: 1%;
      }
      .nav-tabs.nav-justified>li>a {
        margin-bottom: 0;
      }
    }

    .nav-tabs.nav-justified>li>a {
      margin-right: 0;
      border-radius: 4px;
    }

    .nav-tabs.nav-justified>.active>a,
    .nav-tabs.nav-justified>.active>a:hover,
    .nav-tabs.nav-justified>.active>a:focus {
      border: 1px solid #dddddd;
    }

    @media (min-width: 768px) {
      .nav-tabs.nav-justified>li>a {
        border-bottom: 1px solid #dddddd;
        border-radius: 4px 4px 0 0;
      }
      .nav-tabs.nav-justified>.active>a,
      .nav-tabs.nav-justified>.active>a:hover,
      .nav-tabs.nav-justified>.active>a:focus {
        border-bottom-color: #f6f6f7;
      }
    }

    .nav.nav-tabs {
      margin-left: 5%;
      width: 90%;
    }

    .custom-ul {
      /*padding-bottom: 50px;*/
      padding-top: 50px;
    }

    .custom-li {
      /*padding-bottom: 15px;*/
      padding-top: 15px;
    }

    .custom-a {
      padding: 15px;
    }

    .file_attachments h2 {
      float: none !important;
    }

    .field-container {
      height: 39.5px;
      margin-bottom: 10px;
    }

    button.button__modal_submit {
      width: 100%;
      height: 39.5px;
      margin-top: 20px !important;
    }

    form>fieldset {
      margin-bottom: 20px;
    }

    .stats2 {
      color: #11493b;
      font-size: .875em;
      font-family: Lato, sans-serif;
    }

    .star-filled {
      color: #11493b;
    }

    .star-empty {
      color: #757575;
    }
  </style>

  <main class="appmain" ng-class="{anonymous: isAnonymous}">
    <article class="proposal__single">
      <header class="page__header contributionHeader">
        <div class="row">
          <breadcrumb label="proposal.title"></breadcrumb>
          <button class="btn btn-default follow-contribution" ng-if="contributionType">Follow {{contributionType == 'PROPOSAL' ? 'Proposal' : 'Idea'}}</button>
        </div>
       <!--<div class="row type" ng-if="contributionType != 'IDEA'">
          <i class="fa fa-file-text"></i>&nbsp;&nbsp;{{contributionType}}
          <span class="status">â€” {{proposal.status | translate}}</span>
        </div>-->
        <div class="row title_block">
          <h1 class="heading--title">{{proposal.title}}</h1>

          <div class="heading_actions">
            <ul class="actions">
              <li class="action__contextual_menu" ng-mouseenter="cm.isHover = true">
                <a>
                  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
                    y="0px" width="15.998px" height="16px" viewBox="0 0 16 16" xml:space="preserve">
                    <path class="icon" d="M15.998,6.863v2.312c0,0.084-0.027,0.162-0.083,0.239s-0.125,0.122-0.209,0.136L13.78,9.843
      c-0.132,0.375-0.267,0.69-0.406,0.948c0.243,0.346,0.615,0.825,1.114,1.437c0.069,0.083,0.104,0.171,0.104,0.262
      c0,0.089-0.031,0.169-0.094,0.239c-0.188,0.256-0.531,0.631-1.031,1.123c-0.5,0.493-0.826,0.739-0.979,0.739
      c-0.084,0-0.174-0.03-0.271-0.094l-1.438-1.124c-0.306,0.159-0.621,0.291-0.947,0.396c-0.111,0.944-0.213,1.59-0.303,1.937
      c-0.048,0.195-0.173,0.293-0.375,0.293H6.843c-0.097,0-0.182-0.029-0.255-0.089c-0.074-0.059-0.113-0.134-0.12-0.225l-0.292-1.916
      c-0.34-0.111-0.653-0.24-0.938-0.386l-1.468,1.114c-0.07,0.063-0.156,0.094-0.261,0.094c-0.097,0-0.184-0.037-0.26-0.114
      c-0.875-0.791-1.447-1.374-1.719-1.748c-0.048-0.07-0.073-0.15-0.073-0.239c0-0.084,0.028-0.165,0.084-0.24
      c0.104-0.146,0.281-0.376,0.531-0.692c0.25-0.317,0.438-0.562,0.562-0.734c-0.188-0.348-0.33-0.691-0.427-1.032L0.302,9.51
      C0.211,9.496,0.139,9.451,0.083,9.379C0.027,9.306,0,9.226,0,9.135V6.822c0-0.083,0.027-0.164,0.083-0.239
      c0.056-0.077,0.122-0.122,0.199-0.137l1.937-0.291c0.097-0.32,0.232-0.638,0.406-0.958C2.347,4.802,1.976,4.323,1.51,3.759
      C1.441,3.676,1.406,3.593,1.406,3.51c0-0.07,0.032-0.149,0.094-0.24c0.181-0.25,0.523-0.623,1.025-1.119
      C3.029,1.654,3.357,1.405,3.51,1.405c0.09,0,0.18,0.036,0.271,0.104l1.438,1.116C5.524,2.464,5.84,2.332,6.167,2.228
      c0.11-0.943,0.211-1.589,0.302-1.937C6.517,0.098,6.642,0,6.843,0h2.312C9.252,0,9.337,0.029,9.41,0.089
      c0.073,0.058,0.113,0.134,0.12,0.223l0.291,1.916c0.341,0.111,0.653,0.24,0.938,0.387l1.479-1.116
      c0.062-0.062,0.146-0.094,0.25-0.094c0.09,0,0.177,0.036,0.26,0.104c0.896,0.827,1.469,1.417,1.719,1.771
      c0.048,0.057,0.073,0.132,0.073,0.229c0,0.083-0.028,0.163-0.084,0.239c-0.104,0.146-0.28,0.376-0.53,0.693
      c-0.251,0.315-0.438,0.56-0.563,0.734c0.181,0.347,0.323,0.688,0.427,1.02l1.906,0.292c0.09,0.014,0.163,0.057,0.219,0.13
      C15.971,6.69,15.998,6.773,15.998,6.863z M9.884,9.884c0.521-0.52,0.781-1.149,0.781-1.886c0-0.736-0.26-1.364-0.781-1.884
      c-0.52-0.522-1.149-0.782-1.885-0.782c-0.735,0-1.364,0.26-1.885,0.782C5.593,6.634,5.333,7.262,5.333,7.998
      c0,0.736,0.26,1.366,0.781,1.886c0.521,0.521,1.149,0.78,1.885,0.78C8.735,10.664,9.364,10.404,9.884,9.884z"></path>
                  </svg>
                </a>
              </li>
            </ul>

            <div class="contextual_menu" ng-class="{active: cm.isHover}" ng-mouseleave="cm.isHover = false" style="top: 1em; left: auto; right: 0px;">
              <div class="content">
                <contribution-contextual-items contribution="proposal" is-proposal-idea-stage="isProposalIdeaStage" is-hover="cm.isHover"></contribution-contextual-items>
              </div>
            </div>
          </div>
        </div>
        <!--<p class="row parent_working_group" ng-if="group">
          <i class="fa" ng-class="{'fa-group': !group.isTopic, 'fa-tag': group.isTopic}"></i>
          <a ng-if="isAnonymous" ng-href="/#/v2/p/assembly/{{assemblyID}}/campaign/{{campaignID}}/group/{{groupID}}">{{group.name}}</a>
          <a ng-if="!isAnonymous" ng-href="/#/v2/assembly/{{assemblyID}}/campaign/{{campaignID}}/group/{{groupID}}">{{group.name}}</a>
        </p>-->

        <div class="row attribution">
          <!--<p class="heading--subheader">{{ 'Created by' | translate }}</p>-->
          <div ng-repeat="author in proposal.authors" ng-mouseenter="author.isHover = true" ng-mouseleave="author.isHover = false"
            style="display: inline-block; margin-left: 10px;">
            <member-card user="author"></member-card>
            <i ng-if="author.isHover && userIsAuthor" class="fa fa-trash" style="margin-left: 5px;" ng-click="$parent.deleteAuthor(author)"></i>
          </div>

          <div ng-repeat="author in proposal.nonMemberAuthors" ng-mouseenter="author.isHover = true" ng-mouseleave="author.isHover = false"
               style="display: inline-block; margin-left: 10px;">
            <member-card user="author"></member-card>
            <i ng-if="author.isHover && userIsAuthor" class="fa fa-trash" style="margin-left: 5px;" ng-click="$parent.deleteAuthor(author)"></i>
          </div>
          <!--<member-card ng-if="!proposal.authors" user="group"></member-card>-->
          <br><p class="small"><strong>Last updated: </strong> {{proposal.lastUpdate.split(' ')[0] | date : 'mediumDate'}} <strong>Created: </strong> {{proposal.creation.split(' ')[0] | date : 'mediumDate'}}</p>
        </div>
        <div ng-if="(userIsAuthor || userIsCoordinator || userIsAdmin)" class="row attribution campaign__filters">
          <ul class="search_modes">
            <li class="search_mode__full_text" ng-class="{active: $parent.currentAdd.context === 'THEMES'}">
              <a ng-click="$parent.setAddContext('THEMES')" class="btn-sm">{{ 'Themes' | translate }}</a>
            </li>
            <li class="search_mode__full_text" ng-class="{active: $parent.currentAdd.context === 'AUTHORS'}" ng-if="userIsAuthor">
              <a ng-click="$parent.setAddContext('AUTHORS')" class="btn-sm">{{ 'Authors'| translate }}</a>
            </li>
            <li class="search_mode__full_text" ng-class="{active: $parent.currentAdd.context === 'KEYWORDS'}">
              <a ng-click="$parent.setAddContext('KEYWORDS')" class="btn-sm">{{ 'Keywords'| translate }}</a>
            </li>
          </ul>
          <input class="btn-sm" type="text" name="authors" ng-model="$parent.currentAdd.query" ng-change="$parent.currentAddQueryChange()">
          <fieldset class="tags">
            <div class="autocomplete" ng-if="$parent.currentAdd.suggestionsVisible">
              <ul class="suggestion-list">
                <li ng-repeat="item in $parent.currentAdd.items track by $index" ng-click="$parent.currentAddOnSelect(item)"
                  class="suggestion-item" style="min-height: 50px;">
                  <span ng-bind-html="$parent.currentAddGetText(item)"></span>
                </li>
                <li ng-if="$parent.currentAdd.context === 'KEYWORDS'" ng-click="$parent.currentAddOnSelect({'title': $parent.currentAdd.query, 'type': 'EMERGENT'})"
                    class="suggestion-item" style="min-height: 50px;">
                  <span ng-bind-html="'<strong>Add New Keyword</strong>'"></span>
                </li>
              </ul>
            </div>
          </fieldset>
        </div>

        <ul class="row tags">
          <li class="title">Themes: </li>
          <li ng-repeat="theme in proposal.themes track by $index" ng-mouseenter="theme.isHover = true" ng-mouseleave="theme.isHover = false">
            <a>{{theme.title}}</a>
            <i ng-if="theme.isHover && (userIsAuthor || userIsCoordinator || userIsAdmin)" class="fa fa-trash" style="margin-left: 5px;" ng-click="$parent.deleteTheme(theme)"></i>
            <!--<span ng-if="!$last">,</span>-->
          </li>
        </ul>

        <div class="overlay new_overlay contribution_toolbar" style="display: inline-flex">
          <ul class="overlay_buttons">
            <li class="overlay_button" ng-if="proposal.type == 'PROPOSAL'">
              <a data-toggle="modal" data-target="#ideas">
                <i class="fa fa-lightbulb-o fa-lg"></i><span>{{'Contributing ideas'|translate}}</span>
              </a>
            </li>
            <li class="overlay_button">
              <a data-toggle="modal" data-target="#documents">
                <i class="fa fa-file-text-o fa-lg"></i><span>{{'Documents'|translate}}</span>
              </a>
            </li>
            <li class="overlay_button">
              <a ng-click="seeHistory()">
                <i class="fa fa-history fa-lg"></i><span>{{'History'|translate}}</span>
              </a>
            </li>
            <li class="overlay_button" ng-if="proposal.type == 'PROPOSAL'">
              <a data-toggle="modal" data-target="#media">
                <i class="fa fa-picture-o fa-lg"></i><span>{{'Media'|translate}}</span>
              </a>
            </li>
            <li class="overlay_button" ng-if="proposal.type == 'PROPOSAL'">
              <a data-toggle="modal" data-target="#feedback">
                <i class="fa fa-star-half-o fa-lg"></i><span>{{'Feedback'|translate}}</span>
              </a>
            </li>
          </ul>
          <ul class="votes">
            <li class="downvote">
                <a class="commentcount"><i class="fa fa-comment"></i> {{ isAnonymous ? proposal.forumCommentCount : totalComments }}</a>
              </li>
            <li class="upvote" ng-click="updateFeedback('up')">
                {{upSum}} <a class="thumbs-up"><i class="fa fa-thumbs-up"></i></a>
            </li>
            <li class="downvote" ng-click="updateFeedback('down')">
                {{downSum}} <a class="thumbs-down"><i class="fa fa-thumbs-down"></i></a>
            </li>
            <li class="score" ng-if="proposal.informalScore">
                {{proposal.informalScore}} <i class="fa" ng-class="{'fa-arrow-up': proposal.informalScore > 0, 'fa-arrow-down': proposal.informalScore < 0}"></i>
            </li>
          </ul>
        </div>

      </header>

      <section class="content" ng-if="contributionType == 'PROPOSAL'">
        <div class="proposal-summary">
          <h2>{{'contribution.summary'|translate}}</h2>
          <p class="contribution_description" ng-bind-html="trustedHtml(proposal.text)"></p>
        </div>
        <div class="proposal-text">
          <h2>{{contributionType|titlecase|translate}}</h2>
          <p translate="contribution.body"></p>
          <p translate="contribution.body.empty" ng-if="!proposal.extendedTextPad"></p>
          <div class="text-center" style="margin-top: 2rem" ng-if="!proposal.extendedTextPad">
              <button class="btn btn-default proposal-btn">Etherpad</button>
              <button class="btn btn-default proposal-btn">Google Docs</button>
              <button class="btn btn-default proposal-btn">Default</button>
          </div>
          <div class="text-center" style="margin-top: 2rem" ng-if="extendedTextIsEtherpad && proposal.extendedTextPad">
            <div ng-if="!campaignConfigs['appcivist.campaign.disable-etherpad'] || campaignConfigs['appcivist.campaign.disable-etherpad']==='FALSE'"
                 class="etherpad__wrapper">
              <!-- TODO: load only HTML of etherpad as obtained from backend, do not embed read only version-->
              <iframe ng-if="(!userIsAuthor && etherpadReadOnlyUrl) || !etherpadReadWriteUrl" name="embed_readonly"
                      ng-src="{{etherpadReadOnlyUrl}}" width="100%" height="600px">
              </iframe>
              <iframe ng-if="userIsAuthor && etherpadReadWriteUrl" name="embed_readwrite" ng-src="{{etherpadReadWriteUrl}}"
                      width="100%" height="600px">
              </iframe>
            </div>
          </div>
          <div class="text-center" style="margin-top: 2rem" ng-if="extendedTextIsGdoc && proposal.extendedTextPad">
            <div class="etherpad__wrapper">
              <!-- TODO: load only HTML of etherpad as obtained from backend, do not embed read only version-->
              <iframe ng-if="(!userIsAuthor && gdocUrl)" name="embed_readonly"
                      ng-src="{{gdocUrlMinimal}}" width="100%" height="600px">
              </iframe>
              <iframe ng-if="userIsAuthor && writegDocUrl" name="embed_readwrite"
                      ng-src="{{writegDocUrl}}"
                      width="100%" height="600px">
              </iframe>
            </div>
          </div>
        </div>
      </section>

      <section class="content" ng-if="contributionType == 'IDEA'">
          <div id="media-carousel" class="carousel slide" data-ride="carousel" data-interval="false" ng-if="resourcePictures.length > 0">
            <div class="carousel-inner" role="listbox">
              <div class="item" ng-class="{active:$first}" ng-repeat="picture in resourcePictures">
                <img src="{{picture.url}}">
              </div>
            </div>
            <a class="left carousel-control" role="button" data-target="#media-carousel" data-slide="prev">
              <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </spa>
            <a class="right carousel-control" role="button" data-target="#media-carousel" data-slide="next">
              <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
            <ol class="carousel-indicators">
              <li data-target="#media-carousel" data-slide-to="{{$index}}" ng-class="{active:$first}" ng-repeat="picture in resourcePictures"></li>
            </ol>
          </div>
        <p class="contribution_description" ng-bind-html="trustedHtml(proposal.text)"></p>
      </section>

      <section class="comments__section">
        <div class="row comments-header">
          <div class="col-xs-4 text-left">
            <strong>Comments ({{commentType == 'members' ? proposal.commentCount : proposal.forumCommentCount}})</strong>
          </div>
          <div class="col-xs-8 text-right">
            View comments by:
            <select name="comment-types" ng-model="commentType">
              <option value="public">Public</option>
              <option value="members">Members only</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div class="tab-pane" ng-if="userIsMember && commentType === 'members'">
            <discussion-panel class="col-*-12" ng-if="userIsMember" space-id="proposal.rsID"
                              endpoint-id="proposalID"
                              endpoint="contribution"
                              is-anonymous="isAnonymous"></discussion-panel>
          </div>
          <div class="tab-pane" ng-if="commentType === 'public'">
            <discussion-panel ng-if="!isAnonymous" class="col-md-12" space-id="proposal.forumResourceSpaceId"
                              endpoint-id="proposal.proposalId"
                              endpoint="contribution"
                              public-board="true"
                              is-anonymous="isAnonymous"></discussion-panel>
            <discussion-panel ng-if="isAnonymous" class="col-*-12"
                              space-id="proposal.frsUUID"
                              endpoint-id="proposal.uuid"
                              endpoint="contribution"
                              public-board="true"
                              is-anonymous="isAnonymous"></discussion-panel>
          </div>
        </div>
      </section>
    </article>
    <!-- Nav tabs -->
   <!--  <ul class="nav nav-tabs custom-ul">
      <li role="presentation" class="custom-li" ng-class="{'active': (activeTab === 'Members')}" ng-if="userIsMember"><a class="custom-a" href="" ng-click="changeActiveTab(1)" role="tab" data-toggle="tab">{{ 'Members' | translate }} ({{proposal.commentCount}})</a></li>
      <li role="presentation" class="custom-li" ng-class="{'active': (activeTab === 'Public')}"><a class="custom-a" href="" ng-click="changeActiveTab(2)" role="tab" data-toggle="tab">{{ 'Public' | translate }} ({{proposal.forumCommentCount}})</a></li>
      <li ng-show="(feedbacks && feedbacks.length) || userIsMember" role="presentation" class="custom-li hidden-lg" ng-class="{'active': (activeTab === 'Feedbacks')}">
        <a class="custom-a" href="" ng-click="changeActiveTab(3)" role="tab" data-toggle="tab">{{ 'Textual feedbacks' | translate }}</a>
      </li>
    </ul> -->
    <!-- Tab panes -->
   <!--  <div class="tab-content">
      <div class="tab-pane" ng-class="{'active': activeTab === 'Members'}" ng-if="userIsMember && activeTab === 'Members'">
        <discussion-panel class="col-md-12" ng-if="userIsMember" space-id="proposal.rsID" endpoint-id="proposalID"
          endpoint="contribution"></discussion-panel>
      </div>
      <div class="tab-pane" ng-class="{'active': activeTab === 'Public'}" ng-if="activeTab === 'Public'">
        <discussion-panel ng-if="!isAnonymous" class="col-md-12" space-id="proposal.forumResourceSpaceId" endpoint-id="proposal.proposalId"
          endpoint="contribution" public-board="true"></discussion-panel>
        <discussion-panel ng-if="isAnonymous" class="col-md-12" space-id="proposal.frsUUID" endpoint-id="proposal.uuid"
          endpoint="contribution" public-board="true"></discussion-panel>
      </div>
      <div class="tab-pane" ng-class="{'active': activeTab === 'Feedbacks'}" ng-if="activeTab === 'Feedbacks'">
        <contribution-feedback-panel class="col-md-12" contribution="proposal" public-board="true"></contribution-feedback-panel>
      </div>
    </div> -->

    <modal open-if="modals.addAttachmentForm" close="closeModal('addAttachmentForm')" title="Edit Form" template-id="addAttachmentForm"></modal>


    <script id="addAttachmentForm" type="text/ng-template">
      <div class="modal_content__add_proposal">
        <header class="modal-header" style="padding: 2em;">{{'Add a new file' | translate}}</header>
        <div class="modal-body">
          <form>
            <fieldset>
              <label for="name">{{'Name' | translate}}</label>
              <div class="field-container col-lg-12">
                <input name="name" ng-model="newAttachment.name">
              </div>
            </fieldset>
            <fieldset>
              <label for="file">{{'File' | translate}}</label>
              <div class="field-container col-lg-12">
                <input type="file" name="file" fileread="newAttachment.file">
              </div>
            </fieldset>
          </form>
          <fieldset>
            <button class="button__modal_submit" ng-click="submitAttachment()">{{'Submit' | translate}}</button>
          </fieldset>
        </div>
      </div>
    </script>
  </main>

  <!-- Documents Modal -->
  <div class="modal fade dashboardModal" id="documents" tabindex="-1" role="dialog" aria-labelledby="documentsLabel">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">{{'Close'|translate}} &times;</span></button>
          <h3 class="modal-title" id="documentsLabel">{{proposal.title}}</h3>
          <p>{{ 'Documents' | translate }}</p>
        </div>
        <div class="modal-body">
          <!--
            TODO: investigate why simply using the class dashboardModal does not work
            (or adding another class at the same level the noWorkingGroups in new-dashboard.scss)
          -->
          <div class="noContent" ng-if="!documents || documents.length === 0">
            <h4>{{ 'There are no documents in this campaign' | translate }}</h4>
          </div>
          <ul class="workingGroupList" ng-if="documents && documents.length > 0">
            <li ng-repeat="resource in documents">
              <a class="workingGroupLink" target="_blank"
                  ng-href="{{resource.url}}"><span>{{resource.name}}</span>
                <!--<span class="number"><i class="fa fa-users"></i>32</span>-->
              </a>
            </li>
          </ul>
        </div>
        <div class="modal-footer text-left">
          <a data-dismiss="modal"><i class="fa fa-arrow-left fa-lg"></i>{{ 'Return to' | translate }} {{proposal.title}}</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Media Modal -->
  <div class="modal fade dashboardModal" id="media" tabindex="-1" role="dialog" aria-labelledby="mediaLabel" ng-if="proposal.type == 'PROPOSAL'">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">{{'Close'|translate}} &times;</span></button>
          <h3 class="modal-title" id="mediaLabel">{{proposal.title}}</h3>
          <p>{{ 'Media' | translate }}</p>
        </div>
        <div class="modal-body">
          <!--
            TODO: investigate why simply using the class dashboardModal does not work
            (or adding another class at the same level the noWorkingGroups in new-dashboard.scss)
          -->
          <div class="noContent" ng-if="!media || media.length === 0">
            <h4>{{ 'There are no multimedia resources in this proposal' | translate }}</h4>
          </div>

          <div id="media-carousel" class="carousel slide" data-ride="carousel" data-interval="false">
            <div class="carousel-inner" role="listbox">
              <div class="item {{$index===0 ? 'active' : ''}}" ng-repeat="resource in media track by $index">
                <img ng-if="resource.resourceType === 'PICTURE'" ng-src="{{resource.url}}" alt="{{resource.name}}">
                <!-- TODO: sanitize video URLs somewhere else -->
                <iframe ng-if="resource.resourceType === 'VIDEO'" width="75%" height="315"
                        ng-src="{{resource.url.replace('watch?v=', 'embed/');}}"
                        frameborder="0" allowfullscreen style="display: block; margin: auto;"></iframe>
                <div class="noContent">
                  <h4 ng-if="resource.title">{{resource.title}}</h4>
                  <h5 ng-if="resource.description"
                      ng-bind-html="resource.description"></h5>
                </div>

              </div>
            </div>
            <!-- Controls -->
            <a class="left carousel-control" data-target="#media-carousel" role="button" data-slide="prev" ng-if="media.length > 0">
              <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
              <span class="sr-only">{{'Previous'|translate}}</span>
            </a>
            <a class="right carousel-control" data-target="#media-carousel" role="button" data-slide="next" ng-if="media.length > 0">
              <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
              <span class="sr-only">{{'Next'|translate}}</span>
            </a>
            <ol class="carousel-indicators" ng-if="media.length > 0">
              <li data-target="#media-carousel" data-slide-to="{{$index}}" ng-repeat="resource in media track by $index" class="{{$index===0 ? 'active' : ''}}"></li>
            </ol>
          </div>
        </div>
        <div class="modal-footer text-left">
          <a data-dismiss="modal"><i class="fa fa-arrow-left fa-lg"></i>{{ 'Return to' | translate }} {{proposal.title}}</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Feedback Modal -->
  <div class="modal fade dashboardModal" id="feedback" tabindex="-1" role="dialog" aria-labelledby="feedbackLabel">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">{{'Close'|translate}} &times;</span></button>
          <h3 class="modal-title" id="feedbackLabel">{{proposal.title}}</h3>
          <p>{{ 'Feedback' | translate }}</p>
        </div>
        <div class="modal-body">
          <div class="informal_score">
            <div class="informal_score stats2">
              <div style="margin-bottom: 1rem;">
                <div class="col-xs-6 text-right">
                  <span style="font-weight: bold; margin-right: 1rem;">{{ 'Needs' | translate }}</span>
                </div>
                <div class="col-xs-6">
                  <span class="glyphicon glyphicon-star" ng-class="i" ng-repeat="i in createArray(needAvg) track by $index"></span>
                </div>
              </div>
              <div style="margin-bottom: 1rem;">
                <div class="col-xs-6 text-right">
                  <span style="font-weight: bold; margin-right: 1rem;">{{ 'Feasibility' | translate }} </span>
                </div>
                <div class="col-xs-6">
                  <span class="glyphicon glyphicon-star" ng-class="i" ng-repeat="i in createArray(feasibilityAvg) track by $index"></span>
                </div>
              </div>
              <div style="margin-bottom: 1rem;">
                <div class="col-xs-6 text-right">
                  <span style="font-weight: bold; margin-right: 1rem;">{{ 'Benefit' | translate }}</span>
                </div>
                <div class="col-xs-6">
                  <span class="glyphicon glyphicon-star" ng-class="i" ng-repeat="i in createArray(benefictAvg) track by $index"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer text-left">
          <a data-dismiss="modal"><i class="fa fa-arrow-left fa-lg"></i>{{ 'Return to' | translate }} {{proposal.title}}</a>
        </div>
      </div>
    </div>
  </div>

  <script>
    $(document).ready(function() {
      $("a.carousel-control").on("click", function(e) {
        e.preventDefault();
      })
    })
  </script>
