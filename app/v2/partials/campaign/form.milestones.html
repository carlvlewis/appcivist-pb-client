<section class="comments__section">
  <div class="row" id="prePhase2">
    <div>
      <div id="campaignMilestoneDefinition" class="row box descriptionBox row col-md-12 col-sm-12 col-xs-12">
        <p>
          <span>
            {{'Select a phase in the timeline to Edit, or add a new phase to the Campaign timeline. The timeline on the top of the page shows how your campaign timeline will be displayed.' |  translate}}
          </span>
        </p>
      </div>

      <form name="newCampaignForm2">
        <section>
          <campaign-timeline title="{{'Campaign Timeline' | translate}}" components="newCampaign.proposalComponents"
            on-component-click="onComponentClick(component)"></campaign-timeline>
        </section>

        <section>
          <div class="row componet-definition">
            <div class="component-definition-header">
              <h3>{{'Selected Phase' | translate}}</h3>
              <button type="button" ng-click="addNewPhase()">
                <i class="fa fa-plus"></i>
              </button>
              <button type="button" ng-click="deleteSelectedPhase()" style="background-color: #d9534f; border-color: #d9534f;">
                 <i class="fa fa-trash"></i>
              </button>
            </div>
          </div>
          <fieldset class="col-lg-6">
            <label for="group">{{'Stage name' | translate}}</label>
            <div class="field-container">
              <input ng-model="selectedComponent.title" type="text" class="col-lg-12">
            </div>
          </fieldset>

          <fieldset class="col-lg-6">
            <label for="group">{{'Type' | translate}}</label>
            <div class="field-container">
              <select name="type" class="col-lg-12" ng-model="selectedComponent.type" ng-options="type as type for type in componentTypes"></select>
            </div>
          </fieldset>

          <fieldset class="col-lg-12">
            <label for="group">{{'Stage description' | translate}}</label>
            <div class="field-container">
              <textarea rows="8" ng-model="selectedComponent.description"></textarea>
            </div>
          </fieldset>
        </section>

        <section ng-show="selectedComponent.milestones">
          <div class="row component-definition-header">
            <h3>{{'Stage Milestones' | translate}}</h3>
            <button type="button" ng-click="addNewMilestone()">
              <i class="fa fa-plus"></i>
            </button>

            <div id="campaignMilestoneDefinition" class="row box descriptionBox row col-md-12 col-sm-12 col-xs-12">
              <p>
                <span>
                  {{ 'stage.milestones.help.1' |  translate}}
                  {{ 'stage.milestones.help.2' |  translate}}
                  {{ 'stage.milestones.help.3' |  translate}}
                  {{ 'stage.milestones.help.4' |  translate}}
                </span>
              </p>
            </div>
          </div>

          <uib-accordion close-others="true">
            <div uib-accordion-group class="panel-default" ng-repeat="milestone in selectedComponent.milestones">
              <uib-accordion-heading>
                {{milestone.title}} - {{formatDate(milestone.date)}} <i class="pull-right fa fa-trash"
                  ng-click="$event.stopPropagation();$event.preventDefault();deleteMilestone(milestone)"></i>
              </uib-accordion-heading>


              <fieldset class="col-lg-6">
                <label for="group">{{'Title' | translate}}</label>
                <div class="field-container">
                  <input ng-model="milestone.title" type="text" class="col-lg-12">
                </div>
              </fieldset>

              <fieldset class="col-lg-3">
                <label for="group">{{'Type' | translate}}</label>
                <div class="field-container">
                  <select name="type" class="col-lg-12" ng-model="milestone.type" ng-options="type as type for type in milestoneTypes"></select>
                </div>
              </fieldset>

              <fieldset class="col-lg-3">
                <label for="group">{{'Date' | translate}}</label>
                <p class="input-group">
                  <input type="text" class="form-control" uib-datepicker-popup ng-model="milestone.date" is-open="datepicker.opened"
                    datepicker-options="dateOptions" ng-required="true" close-text="{{'Close' | translate}}"
                  />
                  <span class="input-group-btn">
                    <button type="button" class="btn btn-default" ng-click="datepicker.opened = true"><i class="glyphicon glyphicon-calendar"></i></button>
                  </span>
                </p>

              </fieldset>

              <fieldset class="col-lg-12">
                <label for="group">{{'Description' | translate}}</label>
                <div class="field-container">
                  <textarea rows="8" ng-model="milestone.description"></textarea>
                </div>
              </fieldset>
            </div>
          </uib-accordion>
        </section>

        <div class="row vertical-space-medium"></div>
        <div id="campaignButtons2" class="row">
          <div class="col-md-4">
            <button class="btn btn-success col-md-12" uib-tooltip="{{info.campaignFastrackTooltip}}" ng-disabled="!newCampaignForm2.$valid"
              ng-click="createOrUpdateCampaign('done', {fastrack:true})">
              {{'Fastrack' | translate}}
            </button>
          </div>
          <div class="col-md-4">
            <button class="btn btn-primary col-md-12" uib-tooltip="{{info.campaignFastrackTooltip}}" ng-disabled="!newCampaignForm2.$valid"
              ng-click="createOrUpdateCampaign('v2.assembly.aid.campaign.new.description', {aid: assemblyID, fastrack:false})">
               {{'Back' | translate}}
            </button>
          </div>
          <div class="col-md-4">
            <button class="btn btn-primary col-md-12" ng-click="createOrUpdateCampaign('v2.assembly.aid.campaign.new.stages', {aid: assemblyID, fastrack:false})"
              ng-disabled="!newCampaignForm2.$valid">
              {{'Next' | translate}}
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</section>