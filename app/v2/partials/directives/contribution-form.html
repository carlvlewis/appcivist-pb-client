<form name="contributionForm">
  <div class="modal_content__add_proposal" ng-if="vm.isIdea">
    <header class="modal-header" ng-style="vm.coverPhotoStyle">
      <div class="file-field">
        <div class="add-button">
          <button class="btn add-button-item" type="button" ngf-select="vm.uploadFile($file, 'cover')" accept="*/*"
            ngf-max-size="{{vm.coverPhotoSize}}MB">
            {{ 'Edit Cover Photo' |  translate}}
          </button>
          <div class="image-capsule add-button-item" ng-if="vm.fileLoaded">
            <img alt="{{vm.contribution.cover.name}}" ng-src="{{vm.contribution.cover.url}}" class="image-circle image-circle-selected">
          </div>
        </div>
      </div>

      <div class="field__container" ng-if="!vm.hiddenFieldsMap['title']">
        <!--<label for="add_proposal__title">{{'Title of Idea' | translate}} </label>-->
        <input ng-model="vm.contribution.title" class="title" ng-required="true" ng-disabled="vm.disabled" id="add_proposal__title"
          type="text" placeholder="{{ 'Title of Idea' | translate }}..." name="title" ng-maxlength="50">
        <div ng-messages="contributionForm.title.$error" style="color:maroon" role="alert">
          <div ng-message="required">{{'This field is required' | translate}}</div>
          <div ng-message="maxlength">{{'Value is too long' | translate}}, 50 {{'characters allowed' | translate}}</div>
        </div>
      </div>
    </header>
    <div class="modal-body">
      <fieldset>
        <!-- Description -->
        <div class="field__container" ng-if="!vm.hiddenFieldsMap['description']">
          <p for="add_proposal__description" class="bold">{{'What is your Idea?' | translate}} <abbr title="Required">*</abbr></p>
          <label>{{'Where will this occur? Who will benefit? Why is this needed?' | translate}}</label>
          <textarea ui-tinymce="vm.tinymceOptions" ng-model="vm.contribution.text" ng-required="true" ng-disabled="disabled"
            id="add_proposal__description" name="text" rows="8" cols="48" placeholder="{{'Description' | translate}}"></textarea>
          <div ng-messages="contributionForm.text.$error" style="color:maroon" role="alert">
            <div ng-message="required">{{'This field is required' | translate}}</div>
          </div>
          <div style="color:maroon" role="alert">
            <div ng-show="contribution.text.length > 200">{{'Value is too long' | translate}}, 200 {{'characters allowed' | translate}}</div>
          </div>
        </div>


        <!-- Themes -->
        <div class="field__container assign_proposal_to_users" ng-if="vm.isCreate && !vm.hiddenFieldsMap['officialThemes']">
          <fieldset class="add_proposal__availble_themes">
            <p class="intro bold">{{'Idea Themes' | translate}} *</p>
            <label class="add_proposal__categories_label">{{'idea.form.themes.description' | translate : vm.campaign}}</label>
            <tags-field load-items="vm.loadOfficialThemes(query)" options="vm.themesOptions" selected="vm.contribution.officialThemes"
              prefetch="true" disabled="vm.disabled"></tags-field>
          </fieldset>
        </div>

        <!-- Keywords -->
        <div class="field__container assign_proposal_to_users" ng-if="vm.isCreate && !vm.hiddenFieldsMap['emergentThemes']">
          <fieldset class="add_proposal__availble_themes">
            <p class="intro bold">
              {{'Idea Keywords' | translate}}
              <i class="fa fa-question-circle" tooltip-placement="right" uib-tooltip="{{'help.tooltip.idea.form.keywords' | translate}}"
                data-toggle="tooltip" data-placement="right" title=""></i>
            </p>
            <label class="add_proposal__categories_label">{{'idea.form.keywords' | translate}}</label>
            <tags-field load-items="vm.loadEmergentThemes(query)" options="vm.themesOptions" selected="vm.contribution.emergentThemes"
              prefetch="true" disabled="vm.disabled" can-add="true"></tags-field>
          </fieldset>
        </div>

        <div class="field__container" ng-if="(vm.campaignFields && vm.campaignFields.length) || (vm.componentFields && vm.componentFields.length)">
          <fieldset>
            <p class="intro">{{'Custom information' | translate}}</p>
            <custom-field ng-repeat="field in vm.campaignFields | orderBy:'position'" definition="field" value="vm.values[field.customFieldDefinitionId]"></custom-field>
            <custom-field ng-repeat="field in vm.componentFields | orderBy:'position'" definition="field" value="vm.values[field.customFieldDefinitionId]"></custom-field>
          </fieldset>
        </div>

        <!-- Non Member Author -->
        <p class="intro bold">{{'Idea Author(s) Information' | translate}}</p>
        <span>
          {{'idea.form.author.disclaimer' | translate : vm.campaign}}
        </span>
        <div class="field__container assign_proposal_to_users nonmember_author" ng-if="vm.isCreate && !vm.hiddenFieldsMap['non-member-authors']">
          <fieldset class="user__assignment">
            <uib-accordion close-others="true">
              <div uib-accordion-group ng-repeat="author in vm.contribution.nonMemberAuthors" is-open="author.isOpen">
                <uib-accordion-heading>
                  <i class="pull-right fa fa-trash" ng-click="$event.stopPropagation();$event.preventDefault();vm.deleteAuthor(author)"></i>
                  <h5 ng-if="!author.name">{{'Author Information' | translate}}</h5>
                  <h5 ng-if="author.name">{{author.name}}</h5>
                </uib-accordion-heading>
                <nonmember-author-form id="non-member-authors" author="author" ng-disabled="vm.disabled"></nonmember-author-form>
              </div>
            </uib-accordion>
          </fieldset>

          <button class="btn btn-default" ng-click="vm.addNewAuthor()">{{'Add another author' | translate}}</button>
        </div>

        <fieldset>
          <a class="button__modal_submit" ng-click="vm.submit()">{{'Save and submit' | translate}}</a>
        </fieldset>
      </fieldset>
    </div>
  </div>
</form>